<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Create Game - Tambola Live</title>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/css/redesign.css">
</head>
<body>
    <div class="background-animation">
        <div class="gradient-orb orb-1"></div>
        <div class="gradient-orb orb-2"></div>
        <div class="gradient-orb orb-3"></div>
        <div class="grid-overlay"></div>
    </div>

    <nav class="navbar glass">
        <div class="container">
            <div class="nav-wrapper">
                <a href="/" class="logo">
                    <div class="logo-icon">
                        <svg viewBox="0 0 40 40" fill="none">
                            <circle cx="20" cy="20" r="18" fill="url(#logoGradient)"/>
                            <text x="50%" y="50%" dominant-baseline="middle" text-anchor="middle" fill="white" font-size="22" font-weight="800">T</text>
                            <defs>
                                <linearGradient id="logoGradient" x1="0" y1="0" x2="40" y2="40">
                                    <stop offset="0%" stop-color="#6366f1"/>
                                    <stop offset="100%" stop-color="#a855f7"/>
                                </linearGradient>
                            </defs>
                        </svg>
                    </div>
                    <span class="logo-text">Tambola<span class="accent">Live</span></span>
                </a>
                <div class="nav-actions">
                    <button class="btn btn-ghost" onclick="window.location.href='/dashboard.html'">‚Üê Back to Dashboard</button>
                </div>
            </div>
        </div>
    </nav>

    <div style="min-height: 100vh; padding: 140px 0 80px;">
        <div class="container" style="max-width: 800px;">
            <div style="text-align: center; margin-bottom: 48px;">
                <h1 style="font-size: 2.5rem; font-weight: 800; margin-bottom: 12px; color: white;">Create New Game</h1>
                <p style="color: var(--gray-500); font-size: 1.125rem;">Set up your Tambola game and start hosting!</p>
            </div>

            <form id="createGameForm" class="glass" style="padding: 48px; border-radius: 24px;">
                <!-- Game Details -->
                <div style="margin-bottom: 32px;">
                    <h3 style="font-size: 1.25rem; font-weight: 700; margin-bottom: 20px; color: white;">Game Details</h3>
                    
                    <div class="form-group" style="margin-bottom: 20px;">
                        <label class="form-label">Game Title</label>
                        <input type="text" class="form-input" id="gameTitle" placeholder="e.g., Friday Night Jackpot" required>
                    </div>

                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                        <div class="form-group">
                            <label class="form-label">Ticket Price ($)</label>
                            <input type="number" class="form-input" id="ticketPrice" placeholder="5" min="1" max="1000" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Max Players</label>
                            <input type="number" class="form-input" id="maxPlayers" placeholder="100" min="10" max="500" required>
                        </div>
                    </div>
                </div>

                <!-- Prize Distribution -->
                <div style="margin-bottom: 32px;">
                    <h3 style="font-size: 1.25rem; font-weight: 700; margin-bottom: 20px; color: white;">Prize Pool Distribution</h3>
                    
                    <div style="display: grid; gap: 16px;">
                        <div class="form-group">
                            <label class="form-label">üéØ Early Five ($)</label>
                            <input type="number" class="form-input" id="prizeEarlyFive" placeholder="50" min="0" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">üìä Top Line ($)</label>
                            <input type="number" class="form-input" id="prizeTopLine" placeholder="75" min="0" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">üìä Middle Line ($)</label>
                            <input type="number" class="form-input" id="prizeMiddleLine" placeholder="75" min="0" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">üìä Bottom Line ($)</label>
                            <input type="number" class="form-input" id="prizeBottomLine" placeholder="75" min="0" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">üèÜ Full House ($)</label>
                            <input type="number" class="form-input" id="prizeFullHouse" placeholder="200" min="0" required>
                        </div>
                    </div>
                    
                    <div style="margin-top: 20px; padding: 20px; background: rgba(99,102,241,0.1); border: 1px solid rgba(99,102,241,0.2); border-radius: 12px;">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <span style="font-weight: 600; color: var(--gray-300);">Total Prize Pool:</span>
                            <span style="font-size: 1.5rem; font-weight: 800; color: white;" id="totalPrizePool">$0</span>
                        </div>
                    </div>
                </div>

                <!-- Game Settings -->
                <div style="margin-bottom: 32px;">
                    <h3 style="font-size: 1.25rem; font-weight: 700; margin-bottom: 20px; color: white;">Game Settings</h3>
                    
                    <div class="form-group" style="margin-bottom: 20px;">
                        <label class="form-label">Start Time</label>
                        <select class="form-input" id="startTime" required>
                            <option value="now">Start Immediately</option>
                            <option value="5">Start in 5 minutes</option>
                            <option value="15">Start in 15 minutes</option>
                            <option value="30">Start in 30 minutes</option>
                            <option value="60">Start in 1 hour</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                            <input type="checkbox" id="autoStart" style="width: 20px; height: 20px; accent-color: var(--primary-500);">
                            <span style="color: var(--gray-300); font-weight: 500;">Auto-start when minimum players join (10 players)</span>
                        </label>
                    </div>
                </div>

                <!-- Action Buttons -->
                <div style="display: flex; gap: 16px;">
                    <button type="submit" class="btn btn-large btn-primary gradient-shine" style="flex: 1;">
                        <span>üéÆ Create Game</span>
                    </button>
                    <button type="button" class="btn btn-large btn-glass" onclick="window.history.back()">
                        <span>Cancel</span>
                    </button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // Check if user is host
        const user = JSON.parse(localStorage.getItem('user') || '{}');
        if (user.role !== 'host') {
            alert('Only hosts can create games!');
            window.location.href = '/dashboard.html';
        }

        // Calculate total prize pool
        function updateTotalPrize() {
            const early = parseFloat(document.getElementById('prizeEarlyFive').value) || 0;
            const top = parseFloat(document.getElementById('prizeTopLine').value) || 0;
            const middle = parseFloat(document.getElementById('prizeMiddleLine').value) || 0;
            const bottom = parseFloat(document.getElementById('prizeBottomLine').value) || 0;
            const full = parseFloat(document.getElementById('prizeFullHouse').value) || 0;
            
            const total = early + top + middle + bottom + full;
            document.getElementById('totalPrizePool').textContent = `$${total}`;
        }

        // Add event listeners to prize inputs
        ['prizeEarlyFive', 'prizeTopLine', 'prizeMiddleLine', 'prizeBottomLine', 'prizeFullHouse'].forEach(id => {
            document.getElementById(id).addEventListener('input', updateTotalPrize);
        });

        // Handle form submission
        document.getElementById('createGameForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const gameData = {
                title: document.getElementById('gameTitle').value,
                ticketPrice: parseFloat(document.getElementById('ticketPrice').value),
                maxPlayers: parseInt(document.getElementById('maxPlayers').value),
                prizes: {
                    earlyFive: parseFloat(document.getElementById('prizeEarlyFive').value),
                    topLine: parseFloat(document.getElementById('prizeTopLine').value),
                    middleLine: parseFloat(document.getElementById('prizeMiddleLine').value),
                    bottomLine: parseFloat(document.getElementById('prizeBottomLine').value),
                    fullHouse: parseFloat(document.getElementById('prizeFullHouse').value)
                },
                startTime: document.getElementById('startTime').value,
                autoStart: document.getElementById('autoStart').checked,
                hostId: user.id
            };

            console.log('Creating game:', gameData);
            
            // Show success message
            alert('üéâ Game created successfully!\nGame code will be generated and players can join now.');
            
            // Redirect to game management page
            window.location.href = '/dashboard.html';
        });
    </script>
</body>
</html>
